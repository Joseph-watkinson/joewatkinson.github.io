<!doctype html> 
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Live MITM Attack Detection with JA3 Fingerprinting — Project</title>
  <link rel="stylesheet" href="../css/styles.css" />
</head>
<body>
  <header class="nav">
    <div class="brand"><a href="../index.html">← Portfolio</a></div>
  </header>

  <section class="section">
    <h1>Live MITM Attack Detection with JA3 Fingerprinting</h1>

    <h3>Objective</h3>
    <p>
      Demonstrate that TLS interception via a man-in-the-middle (MITM) proxy
      produces detectable differences in handshake fingerprints. The project
      shows how JA3 hashing of ClientHello messages can distinguish malicious
      sessions from legitimate ones.
    </p>

    <h3>Environment & Threat Model</h3>
    <ul>
      <li>Three VMs: <strong>client</strong>, <strong>attacker</strong> (Mitmproxy), and <strong>webserver</strong>.</li>
      <li>Client configured to trust attacker’s proxy certificate.</li>
      <li>Wireshark with JA3 plugin used to capture ClientHello messages and generate hashes.</li>
      <li>Threat model assumption: attacker can insert themselves between client and server by controlling the client’s proxy settings.</li>
    </ul>

    <h3>Methodology & Process</h3>
    <p>
      I configured three virtual machines: a client, an attacker using
      Mitmproxy, and a webserver. This setup gave me control over both ends of
      the traffic flow and the ability to introduce and observe an active
      interception. I enabled the JA3 plugin in Wireshark to capture and hash
      TLS ClientHello messages.
    </p>

    <figure>
      <img src="../assets/img/ProxySettings.png" 
           alt="Firefox proxy settings to enable MITM proxy"
           style="width:100%;max-width:900px;border:1px solid #30363d;border-radius:8px;">
      <figcaption>Figure 1: Firefox proxy settings to enable MITM proxy.</figcaption>
    </figure>

    <p>
      I first captured baseline traffic from the client’s browser connecting
      directly to the server. I then placed the attacker in the middle using
      Mitmproxy, repeated the connection, and captured that traffic. Both
      captures were analysed individually in Wireshark, where I noted the JA3
      fingerprints for comparison.
    </p>

    <figure>
      <img src="../assets/img/LegitimateHash.png" 
           alt="Unique JA3 fingerprint generated for legitimate browser session"
           style="width:100%;max-width:900px;border:1px solid #30363d;border-radius:8px;">
      <figcaption>Figure 2: Unique JA3 fingerprint generated from legitimate browser session.</figcaption>
    </figure>

    <figure>
      <img src="../assets/img/MaliciousHash.png" 
           alt="Unique JA3 fingerprint generated for Mitmproxy connection"
           style="width:100%;max-width:900px;border:1px solid #30363d;border-radius:8px;">
      <figcaption>Figure 3: Unique hash generated by JA3 for Mitmproxy connection.</figcaption>
    </figure>

    <h3>Results</h3>
    <p>
      The JA3 hash from the clean browser session was different from the hash
      produced when Mitmproxy intercepted the traffic. This confirmed that TLS
      handshake characteristics change in a detectable way when a MITM proxy is
      present.
    </p>

    <h3>Analysis</h3>
    <ul>
      <li><strong>Demonstrated risk:</strong> JA3 fingerprints highlight deviations in handshake parameters introduced by interception.</li>
      <li><strong>Limitations:</strong> JA3 can be evaded by sophisticated attackers who mimic legitimate fingerprints; fingerprints also vary across browsers and versions.</li>
      <li><strong>Learning outcome:</strong> Built and analysed an intercepted TLS environment, understood how client-side behaviour is reflected in handshake metadata.</li>
    </ul>

    <h3>Defensive Relevance</h3>
    <ul>
      <li>Security teams can integrate JA3/JA3S into IDS tools such as Suricata or Zeek to flag suspicious sessions.</li>
      <li>Detection requires maintaining up-to-date fingerprint databases to minimise false positives.</li>
      <li>Fingerprinting should be combined with other telemetry (certificate analysis, traffic patterns) for reliable MITM detection.</li>
    </ul>

    <h3>Ethical Context</h3>
    <p>
      This project was conducted in a controlled lab environment. All
      interception was performed on systems I owned and managed.
    </p>

  </section>

  <footer class="footer">
    <small>Designed &amp; coded by me.</small>
  </footer>
</body>
</html>
